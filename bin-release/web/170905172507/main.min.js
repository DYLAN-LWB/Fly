var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Alert=function(t){function e(e,i,r,s,n,h,o){var a=t.call(this)||this;return a.type=e,a.score=i,a.highScore=r,a.ranking=s,a.descstate=n,a.screenwith=h,a.screenHeight=o,a.initView(),a}return __extends(e,t),e.prototype.initView=function(){var t;switch(t=new Bitmap("black_png"),t.height=this.screenHeight,t.width=this.screenwith,t.y=0,this.addChild(t),this.type){case 1:var e=new Bitmap("gamebody_json.prompt_03");e.x=370,e.y=480,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,this.addChild(e);var i=new egret.TextField;i.x=370,i.y=460,i.size=30,i.fontFamily="Microsoft YaHei",i.verticalAlign=egret.VerticalAlign.BOTTOM,i.textColor=16724307,i.text="五次机会已经用完了哦~分享给好友，让好友为你加油，就可以获得重玩的机会呦~",i.lineSpacing=10,i.width=400,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,this.addChild(i);var r=new Bitmap("gamebody_json.btn_03");r.x=230,r.y=610,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleShareGame,this),this.addChild(r);var s=new Bitmap("gamebody_json.btn_05");s.x=510,s.y=610,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareGame,this),this.addChild(s);break;case 2:var n=new Bitmap("gamebody_json.tan");if(n.x=370,n.y=480,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,this.addChild(n),1==this.descstate){var h=new egret.TextField;h.x=140,h.y=380,h.size=32,h.fontFamily="Microsoft YaHei",h.verticalAlign=egret.VerticalAlign.BOTTOM,h.textFlow=[{text:"防作弊系统检测:",style:{textColor:8006727,size:22}},{text:"成绩无效,如有问题,请联系客服",style:{textColor:16719360,size:22}}],h.anchorOffsetY=h.height/2,this.addChild(h)}var o=new egret.TextField;o.x=420,o.y=420,o.size=42,o.fontFamily="Microsoft YaHei",o.verticalAlign=egret.VerticalAlign.BOTTOM,o.textColor=16729701,o.text=this.score,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,this.addChild(o);var a=new egret.TextField;a.x=415,a.y=470,a.size=32,a.fontFamily="Microsoft YaHei",a.verticalAlign=egret.VerticalAlign.BOTTOM,a.textColor=11947535,a.text=this.highScore,a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2,this.addChild(a);var c=new egret.TextField;c.x=400,c.y=520,c.size=32,c.fontFamily="Microsoft YaHei",c.verticalAlign=egret.VerticalAlign.BOTTOM,c.textColor=11947535,c.text=this.ranking,c.anchorOffsetY=c.height/2,this.addChild(c);var d=new Bitmap("gamebody_json.list");d.x=230,d.y=610,d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,d.touchEnabled=!0,d.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gotoRanking,this),this.addChild(d);var _=new Bitmap("gamebody_json.return");_.x=510,_.y=610,_.anchorOffsetX=_.width/2,_.anchorOffsetY=_.height/2,_.touchEnabled=!0,_.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reastGame,this),this.addChild(_);break;case 3:var l=new Bitmap("gamebody_json.prompt_03");l.x=370,l.y=480,l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,this.addChild(l);var g=new egret.TextField;g.x=370,g.y=460,g.size=30,g.fontFamily="Microsoft YaHei",g.verticalAlign=egret.VerticalAlign.BOTTOM,g.textColor=16724307,g.text="五次机会已经用完了哦~分享给好友，让好友为你加油，就可以获得重玩的机会呦~",g.lineSpacing=10,g.width=400,g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,this.addChild(g);var u=new Bitmap("gamebody_json.btn_03");u.x=230,u.y=610,u.anchorOffsetX=u.width/2,u.anchorOffsetY=u.height/2,u.touchEnabled=!0,u.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancleShareGame,this),this.addChild(u);var p=new Bitmap("gamebody_json.btn_05");p.x=510,p.y=610,p.anchorOffsetX=p.width/2,p.anchorOffsetY=p.height/2,p.touchEnabled=!0,p.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareGame,this),this.addChild(p)}},e.prototype.gotoRanking=function(){var t=new AlertEvent(AlertEvent.Ranking);this.dispatchEvent(t)},e.prototype.reastGame=function(){var t=new AlertEvent(AlertEvent.Restart);this.dispatchEvent(t)},e.prototype.shareGame=function(){var t=new AlertEvent(AlertEvent.Share);this.dispatchEvent(t)},e.prototype.cancleShareGame=function(){var t=new AlertEvent(AlertEvent.Cancle);this.dispatchEvent(t)},e.HomePageShare=1,e.GamePageScore=2,e.GamePageShare=3,e}(egret.Sprite);__reflect(Alert.prototype,"Alert");var Game=function(t){function e(){var e=t.call(this)||this;return e._info=new Info,e._person=new Bitmap("person_png"),e._bubble=new Bitmap("papaw_png"),e._isFall=!1,e._allIdiomArray=[],e._currentIdiomArray=[],e._characterArray=[],e._characterTFArray=[],e._characterBgArray=[],e._barrierArray=[],e._isHitBarrier=!1,e._clear=new Bitmap("magic_png"),e._topBarrier=new Bitmap("bg1_png"),e._bottomBarrier=new Bitmap("bg2_png"),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.createGameScene,e),e}return __extends(e,t),e.prototype.createGameScene=function(){this._stageW=this.stage.stageWidth,this._stageH=this.stage.stageHeight,this._scends=180,this._score=0,this._isFall=!0,this._info._vuid=localStorage.getItem("vuid").replace(/"/g,""),this._info._key=localStorage.getItem("key").replace(/"/g,""),this._info._isfrom=localStorage.getItem("isfrom").replace(/"/g,""),this._info._timenum=localStorage.getItem("timenum").replace(/"/g,""),this._info._activitynum=localStorage.getItem("activitynum").replace(/"/g,""),this.minusGameCount()},e.prototype.setupViews=function(){var t=new egret.Sound;t.addEventListener(egret.Event.COMPLETE,function(){this._backgroundChannel=t.play(0,1),this._backgroundChannel.volume=.8},this),t.load("resource/sound/bg.mp3");var e=new Bitmap("bg_jpg");e.x=0,e.y=0,e.width=this._stageW,e.height=this._stageH,this.addChild(e),this._background=new egret.Sprite,this._background.x=-this._stageW,this._background.y=0,this._background.width=3*this._stageW,this._background.height=this._stageH,this.addChild(this._background),this.addBarrier(),this.addCharacter(),this._person.x=300,this._person.y=500,this._person.width=80,this._person.height=80,this.addChild(this._person),this._bubble.texture=RES.getRes("papaw_png"),this._bubble.x=280,this._bubble.y=480,this._bubble.anchorOffsetX=0,this._bubble.anchorOffsetY=0,this._bubble.width=120,this._bubble.height=120,this.addChild(this._bubble),this._guide=new Movie,this._guide.init("guide_json","guide_png","guide",-1),this._guide.x=200,this._guide.y=200,this._guide.width=100,this._guide.height=60,this._guide.alpha=0,this.addChild(this._guide),this._person.addEventListener(egret.Event.ENTER_FRAME,this.freeFall,this),this._clear.x=Math.random()*(3*this._stageW-800)+400,this._clear.y=Math.random()*(this._stageH-600)+300,this._clear.width=80,this._clear.height=80,this._background.addChild(this._clear);var i=new egret.TextField;i.x=0,i.y=250,i.width=this._stageW/2,i.height=50,i.textColor=16777215,i.verticalAlign=egret.VerticalAlign.MIDDLE,i.textAlign=egret.HorizontalAlign.RIGHT,i.size=35,i.text="我的成语：",i.fontFamily="Microsoft YaHei",this.addChild(i),this._currentTF=new egret.TextField,this._currentTF.x=this._stageW/2,this._currentTF.y=250,this._currentTF.width=this._stageW/2,this._currentTF.height=50,this._currentTF.textColor=16776960,this._currentTF.verticalAlign=egret.VerticalAlign.MIDDLE,this._currentTF.textAlign=egret.HorizontalAlign.LEFT,this._currentTF.size=35,this._currentTF.text="",this._currentTF.fontFamily="Microsoft YaHei",this.addChild(this._currentTF),this._scoreTF=new egret.TextField,this._scoreTF.x=90,this._scoreTF.y=35,this._scoreTF.width=333,this._scoreTF.height=55,this._scoreTF.textColor=16739348,this._scoreTF.textAlign=egret.HorizontalAlign.CENTER,this._scoreTF.size=40,this._scoreTF.text=this._score+"分",this._scoreTF.fontFamily="Microsoft YaHei",this.addChild(this._scoreTF),this._scendsTF=new egret.TextField,this._scendsTF.x=.85*this.stage.stageWidth,this._scendsTF.y=35,this._scendsTF.width=.15*this.stage.stageWidth,this._scendsTF.height=55,this._scendsTF.fontFamily="Microsoft YaHei",this._scendsTF.textColor=16739348,this._scendsTF.textAlign=egret.HorizontalAlign.CENTER,this._scendsTF.size=40,this._scendsTF.text=this._scends,this.addChild(this._scendsTF),this._gameTimer=new egret.Timer(1e3,this._scends),this._gameTimer.addEventListener(egret.TimerEvent.TIMER,this.gameTimerFunc,this),this._gameTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.gameTimerCompleteFunc,this),this._gameTimer.start()},e.prototype.addBarrier=function(){if(this._topBarrier.x=0,this._topBarrier.y=110,this._topBarrier.width=this._stageW,this._topBarrier.height=144,this.addChild(this._topBarrier),this._bottomBarrier.x=0,this._bottomBarrier.y=this._stageH-144,this._bottomBarrier.width=this._stageW,this._bottomBarrier.height=144,this.addChild(this._bottomBarrier),this._barrierArray.length>0)for(var t=0;2>t;t++)this._barrierArray[t]&&this._barrierArray[t].parent&&this._barrierArray[t].parent.removeChild(this._barrierArray[t]),this._barrierArray.splice(t,1);for(var e=3*this._stageW/2.5,t=0;2>t;t++){var i=new Bitmap("monster_png");i.x=e*t+300,i.y=Math.random()*(this._stageH-600)+300,i.width=80,i.height=80,this._background.addChild(i),this._barrierArray.push(i)}},e.prototype.addCharacter=function(){this._characterArray.sort();for(var t=0;t<this._characterArray.length;t++){var e=new egret.TextField;e.x=Math.random()*(3*this._stageW-800)+300,e.y=Math.random()*(this._stageH-400)+200,e.width=80,e.height=80,e.text=this._characterArray[t],e.size=35,e.textColor=16777215,e.textAlign=egret.HorizontalAlign.CENTER,e.verticalAlign=egret.VerticalAlign.MIDDLE;var i=t%2==0?"ball1_png":"ball2_png",r=new Bitmap(i);r.x=e.x,r.y=e.y,r.width=80,r.height=80,this._background.addChild(r),this._background.addChild(e);for(var s=0;s<this._characterTFArray.length;s++){var n=this._characterTFArray[s],h=this._characterBgArray[s],o=Math.abs(n.x-e.x),a=Math.abs(h.y-e.y);150>o&&150>a&&(e.y+=e.y>this._stageH/2?-300:300,r.y+=r.y>this._stageH/2?-300:300)}this._characterTFArray.push(e),this._characterBgArray.push(r);for(var c=0;c<this._barrierArray.length;c++){var d=this._barrierArray[c],o=Math.abs(d.x-e.x),a=Math.abs(d.y-e.y);150>o&&150>a&&(e.y+=e.y>this._stageH/2?-300:300,r.y+=r.y>this._stageH/2?-300:300)}}},e.prototype.addTouchEvent=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this)},e.prototype.removeTouchEvent=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this)},e.prototype.touchBegin=function(t){this._isFall=!1,this._touchX=t.localX,this._touchY=t.localY,this._touchPersonX=this._person.x,this._touchPersonY=this._person.y,this._person.addEventListener(egret.Event.ENTER_FRAME,this.touchChangeLocation,this),this.rotationGuide()},e.prototype.touchMove=function(t){this._isFall=!1,this._touchX=t.localX,this._touchY=t.localY,this._touchPersonX=this._person.x,this._touchPersonY=this._person.y,this.rotationGuide()},e.prototype.touchEnd=function(t){this._isFall=!0,this._guide.alpha=0,this._person.removeEventListener(egret.Event.ENTER_FRAME,this.touchChangeLocation,this)},e.prototype.rotationGuide=function(){this._guide.alpha=1,this._guide.x=this._touchX,this._guide.y=this._touchY;var t=Math.atan2(this._touchPersonY+this._person.height/2-this._touchY,this._touchPersonX+this._person.width/2-this._touchX),e=180*t/Math.PI;this._guide.rotation=e},e.prototype.touchChangeLocation=function(){var t=Math.cos((this._touchPersonY-this._touchY)/(this._touchPersonX-this._touchX)),e=Math.sin((this._touchPersonY-this._touchY)/(this._touchPersonX-this._touchX)),i=2.5*(1+Math.abs(t)),r=2.5*(1+Math.abs(e)),s=this._touchX<this._touchPersonX?i:-i,n=this._touchY<this._touchPersonY?r:-r;this._person.x+=s,this._person.y+=n,this._bubble.x=this._person.x-20,this._bubble.y=this._person.y-20,this.moveBackground(s>0?!1:!0,n>0?!1:!0)},e.prototype.freeFall=function(){if(console.log("freefall"),1==this._isFall){var t=this._touchX<this._touchPersonX?3:-3;this._person.x+=t,this._person.y+=3}this._person.y+=1,this._person.x<150&&(this._person.x=150),this._person.x>this._stageW-this._person.width-150&&(this._person.x=this._stageW-this._person.width-150),this._bubble.x=this._person.x-20,this._bubble.y=this._person.y-20,this.checkHit(),this.checkBarrierHit(),this.checkClear()},e.prototype.moveBackground=function(t,e){this._background.x+=t?5:-5,this._background.x>0&&(this._background.x=0),this._background.x<-2*this._stageW&&(this._background.x=-2*this._stageW)},e.prototype.checkHit=function(){for(var t=0;t<this._characterBgArray.length;t++){var e=this._characterBgArray[t],i=e.hitTestPoint(this._person.x+this._person.width/2,this._person.y+this._person.height);i&&this.hitAction(t)}},e.prototype.hitAction=function(t){var e=new egret.Sound;e.addEventListener(egret.Event.COMPLETE,function(){var t=e.play(0,1);t.volume=.9},this),e.load("resource/sound/jump.mp3"),this._currentTF.text+=this._characterTFArray[t].text,this._background.removeChild(this._characterTFArray[t]),this._background.removeChild(this._characterBgArray[t]),this._characterTFArray.splice(t,1),this._characterBgArray.splice(t,1),this._characterArray.splice(t,1),4==this._currentTF.text.length&&this.addNewCharacter()},e.prototype.addNewCharacter=function(){var t=[],e=this._currentTF.text,i="";this._currentTF.text="";for(var r=!1,s=function(s){var h=n._currentIdiomArray[s];if(e==h){console.log("吃对了");var o=new egret.Sound;o.addEventListener(egret.Event.COMPLETE,function(){var t=o.play(0,1);t.volume=.9},n),o.load("resource/sound/rocket.mp3"),n.plusScore(1),n._score+=1,n._scoreTF.text=n._score+"分",r=!0,n._currentIdiomArray.splice(s,1),n._currentIdiomArray.push(n._allIdiomArray[0]);var a=n._allIdiomArray[0].replace(/,/g,"");t=a.split(""),Array.prototype.push.apply(n._characterArray,t),i=n._allIdiomArray[0],n._allIdiomArray.splice(0,1),n._allIdiomArray.length<5&&n.getWords(2)}else console.log("吃错了")},n=this,h=0;h<this._currentIdiomArray.length;h++)s(h);0==r&&(console.log("吃错了"),t=e.split(""),Array.prototype.push.apply(this._characterArray,t)),t.sort();for(var o=0;o<t.length;o++){var a=new egret.TextField;a.x=Math.random()*(3*this._stageW-800)+300,a.y=Math.random()*(this._stageH-600)+300,a.width=80,a.height=80,a.text=t[o],a.size=35,a.textColor=16777215,a.textAlign=egret.HorizontalAlign.CENTER,a.verticalAlign=egret.VerticalAlign.MIDDLE;var c=o%2==0?"ball1_png":"ball2_png",d=new Bitmap(c);d.x=a.x,d.y=a.y,d.width=80,d.height=80,this._background.addChild(d),this._background.addChild(a);for(var h=0;h<this._characterTFArray.length;h++){var _=this._characterTFArray[h],l=this._characterBgArray[h],g=Math.abs(_.x-a.x),u=Math.abs(l.y-a.y);150>g&&150>u&&(a.y+=a.y>this._stageH/2?-300:300,d.y+=d.y>this._stageH/2?-300:300)}this._characterTFArray.push(a),this._characterBgArray.push(d);for(var h=0;h<this._barrierArray.length;h++){var p=this._barrierArray[h],g=Math.abs(p.x-a.x),u=Math.abs(p.y-a.y);150>g&&150>u&&(a.y+=a.y>this._stageH/2?-300:300,d.y+=d.y>this._stageH/2?-300:300)}}},e.prototype.checkBarrierHit=function(){for(var t=0;t<this._barrierArray.length;t++){var e=this._barrierArray[t],i=e.hitTestPoint(this._person.x+this._person.width/2,this._person.y+this._person.height);i&&(0==this._isHitBarrier&&this.gameTimerCompleteFunc(),this._isHitBarrier=!0)}var r=this._topBarrier.hitTestPoint(this._person.x+this._person.width/2,this._person.y+this._person.height),s=this._bottomBarrier.hitTestPoint(this._person.x+this._person.width/2,this._person.y+this._person.height);(r||s)&&(0==this._isHitBarrier&&this.gameTimerCompleteFunc(),this._isHitBarrier=!0)},e.prototype.checkClear=function(){var t=this._clear.hitTestPoint(this._person.x+this._person.width/2,this._person.y+this._person.height);t&&(this._clear.x=Math.random()*(3*this._stageW-800)+400,this._clear.y=Math.random()*(this._stageH-600)+300,this.addNewCharacter())},e.prototype.gameTimerFunc=function(){if(this._scends--,this._scendsTF.text=this._scends,5==this._scends){var t=new egret.Sound;t.addEventListener(egret.Event.COMPLETE,function(){this._countdownChannel=t.play(0,0)},this),t.load("resource/sound/countdown.mp3")}},e.prototype.gameTimerCompleteFunc=function(){this._person.removeEventListener(egret.Event.ENTER_FRAME,this.freeFall,this),this._person.removeEventListener(egret.Event.ENTER_FRAME,this.touchChangeLocation,this),this.removeTouchEvent(),this._countdownChannel&&this._countdownChannel.stop(),this._backgroundChannel&&this._backgroundChannel.stop(),this._gameTimer&&this._gameTimer.stop(),this._bubble.texture=RES.getRes("baozha1_png"),this._bubble.width=300,this._bubble.height=300,this._bubble.anchorOffsetX=90,this._bubble.anchorOffsetY=100,this._bubble.x=this._person.x-110,this._bubble.y=this._person.y-110;var t=new egret.Timer(200,1);t.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this._bubble.texture=RES.getRes("baozha2_png");var t=new egret.Timer(200,1);t.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this._bubble.texture=RES.getRes("baozha3_png")},this),t.start()},this),t.start();var e=new egret.Timer(400,1);e.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this.gameOver()},this),e.start()},e.prototype.minusGameCount=function(){var t="?vuid="+this._info._vuid+"&key="+this._info._key+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(this._info._downnum+t,egret.HttpMethod.GET),console.log(this._info._downnum+t),e.send(),e.addEventListener(egret.Event.COMPLETE,function(){var t=JSON.parse(e.response);if(console.log(t),0==t.code)this._linnum=parseInt(t.data.linnum),this._rands=t.data.rands.toString(),this._tid=t.data.tid.toString(),this.getWords(1);else if(2==t.code){var i=new Alert(Alert.GamePageShare,"","","",0,this._stageW,this._stageH);i.addEventListener(AlertEvent.Share,this.shareButtonClick,this),i.addEventListener(AlertEvent.Cancle,function(){window.location.reload()},this),this.addChild(i)}else alert(t.msg)},this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){alert("numdown5　post error : "+event)},this)},e.prototype.getWords=function(t){var e="?vuid="+this._info._vuid+"&key="+this._info._key+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&rands="+this._rands+"&isfrom="+this._info._isfrom,i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,console.log(this._info._getWord+e),i.open(this._info._getWord+e,egret.HttpMethod.GET),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(),i.addEventListener(egret.Event.COMPLETE,function(){var e=JSON.parse(i.response);if(console.log(e),0==e.code){for(var r=[],s=0;s<e.data.length;s++){var n=e.data[s].right;r.push(n)}if(Array.prototype.push.apply(this._allIdiomArray,r),1==t){this._currentIdiomArray.push(this._allIdiomArray[0]),this._allIdiomArray.splice(0,2);var h=this._currentIdiomArray.join().replace(/,/g,""),o=h.split("");Array.prototype.push.apply(this._characterArray,o),this.setupViews(),this.addTouchEvent()}}else alert(e.msg)},this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){alert("GetBallwords　post error : "+event)},this)},e.prototype.plusScore=function(t){var e="?vuid="+this._info._vuid+"&rands="+this._rands+"&tid="+this._tid+"&md5="+t+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open(this._info._typosTempjump+e,egret.HttpMethod.GET),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(),i.addEventListener(egret.Event.COMPLETE,function(){JSON.parse(i.response)},this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){alert("typostempjump　post error : "+event)},this)},e.prototype.gameOver=function(){var t="?score="+this._score+"&vuid="+this._info._vuid+"&key="+this._info._key+"&rands="+this._rands+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,console.log(this._info._gameover+t),e.open(this._info._gameover+t,egret.HttpMethod.GET),e.send(),e.addEventListener(egret.Event.COMPLETE,function(){var t=JSON.parse(e.response);console.log(t);var i=t.data.score;this._score>parseInt(i)&&(i=this._score),this._normalAlert=new Alert(Alert.GamePageScore,this._score.toString(),i,t.data.order,t.data.text,this._stageW,this._stageH),this._normalAlert.addEventListener(AlertEvent.Ranking,this.checkRanking,this),this._normalAlert.addEventListener(AlertEvent.Restart,this.restartGame,this),this.addChild(this._normalAlert)},this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){alert("GameOver　post error : "+event)},this)},e.prototype.checkRanking=function(){console.log("game 查看排名"),this._normalAlert&&this._normalAlert.parent&&this._normalAlert.parent.removeChild(this._normalAlert),window.location.href=this._info._rankUrl+this._info._timenum+"/activitynum/"+this._info._activitynum+"/vuid/"+this._info._vuid+"/key/"+this._info._key+"/isfrom/"+this._info._isfrom},e.prototype.restartGame=function(){this.removeChildren(),this._allIdiomArray.splice(0,this._allIdiomArray.length),this._currentIdiomArray.splice(0,this._currentIdiomArray.length),this._characterArray.splice(0,this._characterArray.length),this._characterTFArray.splice(0,this._characterTFArray.length),this._characterBgArray.splice(0,this._characterBgArray.length),this._barrierArray.splice(0,this._barrierArray.length),this._scends=180,this._score=0,this._isFall=!0,this._isHitBarrier=!1,this.minusGameCount()},e.prototype.shareButtonClick=function(){var t=new Bitmap("shareGui_png");t.touchEnabled=!0,t.x=0,t.y=0,t.width=this.stage.stageWidth,t.height=this.stage.stageHeight,t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){this.removeChild(t)},this),this.addChild(t)},e}(egret.DisplayObjectContainer);__reflect(Game.prototype,"Game");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=500,this.textField.width=750,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.createGameScene=function(){this.addChild(new Home),RES.getResAsync("description_json",this.startAnimation,this)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Advert=function(t){function e(e,i,r){var s=t.call(this)||this;return s.data=[],s.index=0,egret.ImageLoader.crossOrigin="anonymous",s.graphics.beginFill(16777215),s.graphics.drawRect(0,0,r?e:i,200),s.graphics.endFill(),s.x=r?0:e-200,s.y=r?i-200:i,s.rotation=r?0:-90,s.getAdvertData(),s}return __extends(e,t),e.prototype.getAdvertData=function(){var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT,t.open("https://www.beisu100.com/beisuapp/shop/goodshopone",egret.HttpMethod.GET),t.send(),t.addEventListener(egret.Event.COMPLETE,function(){var e=JSON.parse(t.response);if(console.log(e),0==e.code){this.data=e.data,this.setupAdvertView(),this.commodityChange();var i=new egret.Timer(3e3,999);i.addEventListener(egret.TimerEvent.TIMER,function(){this.commodityChange()},this),i.start()}},this)},e.prototype.commodityChange=function(){var t=10*Math.random();this.index=parseInt(t.toString()),RES.getResByUrl(this.data[this.index].imgurl,function(t){this._image.texture=t,this._title.text=this.data[this.index].name,this._oldPrice.text="原价："+this.data[this.index].shopprice+"元",this._newPrice.text="券后价："+this.data[this.index].shopdisprice+"元",this._coupon.text="券："+this.data[this.index].discount+"元",document.getElementById("code").value=this.data[this.index].code},this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.setupAdvertView=function(){var t=this.textField(0,10,this.width,30,5526612);t.text="倍速小店分享点此进店",t.textColor=13619151,t.textAlign=egret.HorizontalAlign.CENTER,t.verticalAlign=egret.VerticalAlign.MIDDLE,t.size=21,this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){window.location.href="http://www.beisu100.com/weixinbeisu/shop.html"},this);var e=new egret.Shape;e.graphics.beginFill(14079702),e.graphics.drawRect(30,25,.3*this.width,1),e.graphics.endFill(),e.alpha=.5,this.addChild(e);var i=new egret.Shape;i.graphics.beginFill(14079702),i.graphics.drawRect(.7*this.width-30,25,.3*this.width,1),i.graphics.endFill(),i.alpha=.5,this.addChild(i),this._image=new Bitmap(""),this._image.x=30,this._image.y=60,this._image.width=120,this._image.height=120,this.addChild(this._image),this._title=this.textField(160,60,380,30,5526612),this.addChild(this._title),this._oldPrice=this.textField(160,90,380,30,5526612),this.addChild(this._oldPrice);var r=new egret.Shape;r.graphics.beginFill(5526612),r.graphics.drawRect(165,105,150,1),r.graphics.endFill(),this.addChild(r),this._newPrice=this.textField(160,120,380,30,5526612),this._newPrice.textColor=15548690,this.addChild(this._newPrice),this._coupon=this.textField(160,152,150,33,5526612),this._coupon.textColor=15548690,this._coupon.border=!0,this._coupon.borderColor=15548690,this._coupon.borderWidth=2,this._coupon.verticalAlign=egret.VerticalAlign.MIDDLE,this._coupon.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this._coupon);var s=new egret.Sprite;s.graphics.beginFill(13697564),s.graphics.drawRect(560,60,130,130),s.graphics.endFill(),this.addChild(s);var n=new Bitmap("yy_png");n.x=690,n.y=60,n.width=20,n.height=130,this.addChild(n);var h=this.textField(560,90,130,40,5526612);h.text="立即领券",h.textColor=16777215,h.textAlign=egret.HorizontalAlign.CENTER,this.addChild(h);var o=new egret.Shape;o.graphics.beginFill(10747924),o.graphics.drawRoundRect(580,130,90,47,30,30),o.graphics.endFill(),this.addChild(o);var a=this.textField(580,130,90,45,5526612);a.text="购买",a.textColor=16777215,a.textAlign=egret.HorizontalAlign.CENTER,a.verticalAlign=egret.VerticalAlign.MIDDLE,this.addChild(a),this._image.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showToast,this),this._title.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showToast,this),this._oldPrice.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showToast,this),this._newPrice.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showToast,this),this._coupon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showToast,this),h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showToast,this),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showToast,this)},e.prototype.showToast=function(){copyCode();var t=this.textField(200,60,350,50,5526612);t.text="淘口令已复制，打开",t.textColor=16777215,t.textAlign=egret.HorizontalAlign.CENTER,t.verticalAlign=egret.VerticalAlign.BOTTOM,t.background=!0,t.backgroundColor=0,t.alpha=.8,t.lineSpacing=8,this.addChild(t);var e=this.textField(200,110,350,70,5526612);e.text="【手机淘宝】即可购买。",e.textColor=16777215,e.textAlign=egret.HorizontalAlign.CENTER,e.verticalAlign=egret.VerticalAlign.MIDDLE,e.background=!0,e.backgroundColor=0,e.alpha=.8,e.lineSpacing=8,this.addChild(e);var i=new egret.Timer(1500,1);i.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(){this.removeChild(t),this.removeChild(e)},this),i.start()},e.prototype.textField=function(t,e,i,r,s){var n=new egret.TextField;return n.x=t,n.y=e,n.width=i,n.height=r,n.textColor=s,n.size=23,n.fontFamily="Microsoft YaHei",n.touchEnabled=!0,n},e}(egret.Sprite);__reflect(Advert.prototype,"Advert");var Home=function(t){function e(){var e=t.call(this)||this;return e._playCount=-1,e._isPortraitScreen=!0,e._info=new Info,e._pageUrl=window.location.href,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.createGameScene,e),e}return __extends(e,t),e.prototype.createGameScene=function(){var t=window.navigator.userAgent.toLowerCase();"micromessenger"==t.match(/MicroMessenger/i)?/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?this.stage.setContentSize(this._isPortraitScreen?750:1218,this._isPortraitScreen?1218:750):/(Android)/i.test(navigator.userAgent)&&this.stage.setContentSize(this._isPortraitScreen?750:1196,this._isPortraitScreen?1196:750):/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?this.stage.setContentSize(this._isPortraitScreen?750:1218,this._isPortraitScreen?1218:750):/(Android)/i.test(navigator.userAgent)&&this.stage.setContentSize(this._isPortraitScreen?750:1298,this._isPortraitScreen?1298:750);var e=new Bitmap("index_jpg");e.width=this.stage.stageWidth,e.height=this.stage.stageHeight,this.addChild(e),this.getUserInfo(),this.addChild(new Advert(this.stage.stageWidth,this.stage.stageHeight,this._isPortraitScreen))},e.prototype.getUserInfo=function(){var t=this.getUrlParams();this._info._vuid=t.uid.replace(/"/g,""),this._info._key=t.key.replace(/"/g,""),this._info._isfrom=t.isfrom.replace(/"/g,""),this._info._timenum=t.timenum.replace(/"/g,""),this._info._activitynum=t.activitynum.replace(/"/g,""),this._info._key.length<8?(this._info._vuid=localStorage.getItem("vuid").replace(/"/g,""),this._info._key=localStorage.getItem("key").replace(/"/g,""),this._info._isfrom=localStorage.getItem("isfrom").replace(/"/g,""),this._info._timenum=localStorage.getItem("timenum").replace(/"/g,""),this._info._activitynum=localStorage.getItem("activitynum").replace(/"/g,"")):(localStorage.setItem("vuid",JSON.stringify(this._info._vuid)),localStorage.setItem("key",JSON.stringify(this._info._key)),localStorage.setItem("isfrom",JSON.stringify(this._info._isfrom)),localStorage.setItem("timenum",JSON.stringify(this._info._timenum)),localStorage.setItem("activitynum",JSON.stringify(this._info._activitynum))),null==this._info._key&&alert("请先登录！"),0==parseInt(this._info._isfrom)?this.getNumberOfGames():this.setupSubViews()
},e.prototype.getNumberOfGames=function(){var t="?vuid="+this._info._vuid+"&key="+this._info._key+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(this._info._canPalyNumber+t,egret.HttpMethod.GET),e.send(),e.addEventListener(egret.Event.COMPLETE,function(){var t=JSON.parse(e.response);console.log(t),0==t.code&&(this.setupSubViews(),this._playCount=t.data.num,this._playNumText.text="您当前有"+this._playCount+"次挑战机会",0!=t.data.isend&&this.setupOverButton())},this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){alert("num　post error : "+event),this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0},this)},e.prototype.setupOverButton=function(){this.removeChild(this._startButton),this._overButton=new Bitmap("gamebody_json.ending"),this._overButton.x=this._isPortraitScreen?180:780,this._overButton.y=this._isPortraitScreen?700:570,this._overButton.rotation=this._isPortraitScreen?0:-90,this._overButton.touchEnabled=!0,this._overButton.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){alert("活动已结束")},this),this.addChild(this._overButton)},e.prototype.setupSubViews=function(){var t=new egret.TextField;t.x=this._isPortraitScreen?370:365,t.y=this._isPortraitScreen?370:375,t.lineSpacing=15,t.width=600,t.size=25,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.rotation=this._isPortraitScreen?0:-90,this.addChild(t),this._playNumText=new egret.TextField,this._playNumText.size=30,this._playNumText.x=this._isPortraitScreen?220:620,this._playNumText.y=this._isPortraitScreen?630:520,this._playNumText.rotation=this._isPortraitScreen?0:-90,this._playNumText.textColor=2579281,this._playNumText.anchorOffsetX=this._playNumText.width/2,this._playNumText.anchorOffsetY=this._playNumText.height/2,this._playNumText.text="您当前有0次挑战机会",this.addChild(this._playNumText),this._startButton=new Bitmap("startgame_png"),this._startButton.x=this._isPortraitScreen?180:700,this._startButton.y=this._isPortraitScreen?700:570,this._startButton.rotation=this._isPortraitScreen?0:-90,this._startButton.touchEnabled=!0,this._startButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startPlayGame,this),this.addChild(this._startButton),this._rankButton=new Bitmap("ranking_png"),this._rankButton.x=this._isPortraitScreen?180:850,this._rankButton.y=this._isPortraitScreen?850:570,this._rankButton.rotation=this._isPortraitScreen?0:-90,this._rankButton.touchEnabled=!0,this._rankButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.checkRanking,this),this.addChild(this._rankButton),0==parseInt(this._info._isfrom)?t.textFlow=[{text:"通过手指移动控制吹泡泡的方向，使其成功吃到汉字并组成成语，碰到障碍物即游戏结束。根据最高分排名，排名前50都有红包奖励！此外，我们还会随机抽取100名发送幸运红包。每人共有5次挑战机会，",style:{textColor:1663126}},{text:"分享给好友，让好友为你加油，可增加机会呦~",style:{textColor:15874940}}]:1==parseInt(this._info._isfrom)&&(this.removeChild(this._playNumText),t.x=this._isPortraitScreen?370:480,t.y=this._isPortraitScreen?450:375,t.text="通过手指移动控制吹泡泡的方向，使其成功吃到汉字并组成成语，碰到障碍物即游戏结束。 ",this._startButton.x=this._isPortraitScreen?180:660,this._startButton.y=this._isPortraitScreen?660:570,this._rankButton.x=this._isPortraitScreen?180:850,this._rankButton.y=this._isPortraitScreen?810:570)},e.prototype.checkRanking=function(t){window.location.href=this._info._rankUrl+this._info._timenum+"/activitynum/"+this._info._activitynum+"/vuid/"+this._info._vuid+"/key/"+this._info._key+"/isfrom/"+this._info._isfrom},e.prototype.startPlayGame=function(t){this._rankButton.touchEnabled=!1,this._startButton.touchEnabled=!1,0==parseInt(this._info._isfrom)?this._playCount<1?(this._alert=new Alert(Alert.HomePageShare,"","","",0,this.stage.stageWidth,this.stage.stageHeight),this._alert.x=(this._isPortraitScreen,0),this._alert.y=this._isPortraitScreen?0:750,this._alert.rotation=this._isPortraitScreen?0:-90,this._alert.addEventListener(AlertEvent.Share,this.shareButtonClick,this),this._alert.addEventListener(AlertEvent.Cancle,this.cancleButtonClick,this),this.addChild(this._alert)):this.checkIsAttention():($("#guangao").hide(),this.removeChildren(),this.addChild(new Game))},e.prototype.checkIsAttention=function(){var t="?vuid="+this._info._vuid+"&timenum="+this._info._timenum+"&activitynum="+this._info._activitynum+"&isfrom="+this._info._isfrom,e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open(this._info._hasAttention+t,egret.HttpMethod.GET),e.send(),e.addEventListener(egret.Event.COMPLETE,function(){var t=JSON.parse(e.response);console.log(t),0==t.code?this._playCount>0&&($("#guangao").hide(),this.removeChildren(),this.addChild(new Game)):2==t.code&&(this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0,document.getElementById("attention").style.display="block")},this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){alert("isguanzhu　post error : "+event),this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0},this)},e.prototype.cancleButtonClick=function(){this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0,this.removeChild(this._alert)},e.prototype.shareButtonClick=function(){this.removeChild(this._alert);var t=new Bitmap("shareGui_png");t.touchEnabled=!0,t.x=(this._isPortraitScreen,0),t.y=this._isPortraitScreen?0:this.stage.stageHeight,t.width=this._isPortraitScreen?this.stage.stageWidth:this.stage.stageHeight,t.height=this._isPortraitScreen?this.stage.stageHeight:this.stage.stageWidth,t.rotation=this._isPortraitScreen?0:-90,t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){this.removeChild(t),this._rankButton.touchEnabled=!0,this._startButton.touchEnabled=!0},this),this.addChild(t)},e.prototype.getUrlParams=function(){var t=this._pageUrl.indexOf("?"),e=this._pageUrl.substring(t),i=decodeURIComponent(e),r=new Object;if(-1!=i.indexOf("?"))for(var s=i.substr(1),n=s.split("&"),h=0;h<n.length;h++)r[n[h].split("=")[0]]=unescape(n[h].split("=")[1]);return r},e}(egret.DisplayObjectContainer);__reflect(Home.prototype,"Home");var AlertEvent=function(t){function e(e,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),t.call(this,e,i,r)||this}return __extends(e,t),e.Share="share",e.Ranking="ranking",e.Restart="restart",e.Cancle="cancle",e}(egret.Event);__reflect(AlertEvent.prototype,"AlertEvent");var Bitmap=function(t){function e(e){var i=(t.call(this)||this,new egret.Bitmap),r=RES.getRes(e);return i.texture=r,i}return __extends(e,t),e}(egret.Bitmap);__reflect(Bitmap.prototype,"Bitmap");var GameUtil=function(){function t(){}return t.hitTest=function(t,e){var i=t.getBounds(),r=e.getBounds();return i.x=t.x-t.width/2,i.y=t.y-t.height/2,r.x=e.x,r.y=e.y,i.intersects(r)},t.hitTest2=function(t,e){var i=t.getBounds(),r=e.getBounds();return i.x=t.x-t.width/2,i.y=t.y-t.height/2,r.x=e.x-e.width/2,r.y=e.y-e.height/2,i.intersects(r)},t}();__reflect(GameUtil.prototype,"GameUtil");var Info=function(){function t(){this._url="//www.beisu100.com/beisuapp/",this._hasAttention=this._url+"uservote/isguanzhu",this._canPalyNumber=this._url+"typos/num",this._downnum=this._url+"typos/numdown5",this._gameover=this._url+"typos/GameOver",this._typosTempjump=this._url+"typos/typostempjump",this._getWord=this._url+"typos/GetBallwords",this._rankUrl=this._url+"gamerank/rank/timenum/"}return t}();__reflect(Info.prototype,"Info");var Movie=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i,r){var s=RES.getRes(t),n=RES.getRes(e);this.mcf=new egret.MovieClipDataFactory(s,n),this.mc=new egret.MovieClip,this.mc.movieClipData=this.mcf.generateMovieClipData(i),this.mc.play(r),this.addChild(this.mc),this.mc.addEventListener(egret.Event.COMPLETE,this.removeBomb,this)},e.prototype.removeBomb=function(t){null!=this.parent&&this.parent.removeChild(this)},e}(egret.Sprite);__reflect(Movie.prototype,"Movie");